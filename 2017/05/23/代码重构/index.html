
<!DOCTYPE html>
<html lang="zh-CN">


<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="theme-color" content="#202020" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  
  <meta name="keywords" content="SoftwareTesting,重构," />
  

  
  <meta name="description" content="代码重构" />
  

  <link rel="icon" type="image/x-icon" href="/img/logo.png">
  <title>
    代码重构 [ 仁梓小舍 ]
  </title>
  
  <!-- stylesheets list from config.yml -->
  
  <link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css">
  
  <link rel="stylesheet" href="/css/microb.css">
  
  
<link rel="stylesheet" href="/css/prism.css" type="text/css"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav class="home-menu pure-menu pure-menu-horizontal pure-menu-fixed">
  <ul class="pure-menu-list float-r clearfix">
    
    <li class="pure-menu-item toc-menu">
      <a id="menu-main-post" class="pure-menu-link" href="javascript:;">
        <img class="menu-icon" src="/img/logo.png" alt="MENU">
      </a>
    </li>
    
  </ul>
  <a class="pure-menu-heading" href="/">
    <h1 class="title">
      仁梓小舍
    </h1>
    <!-- <span>null</span> -->
  </a>
  <!-- 
  <img class="logo" id="logo" src="/logo.png" alt="logo">
   -->
</nav>

  <div class="container" id="content-outer">
    <div class="inner" id="content-inner">
      <article class="post" id="post">
  <header class="post-header text-center">
    <h1 class="title">
      代码重构
    </h1>
    
    <time class="time" datetime="2017-05-23T08:20:45.000Z">
      2017-05-23
    </time>
    
    <hr>
  </header>
  <div class="post-content">
    <p>重构就是在不改变软件系统外部行为的前提下，改善它的内部结构。</p>
<h2 id="一、Refactoring，the-first-case"><a href="#一、Refactoring，the-first-case" class="headerlink" title="一、Refactoring，the first case"></a>一、Refactoring，the first case</h2><h3 id="1-起始程序缺陷"><a href="#1-起始程序缺陷" class="headerlink" title="1.起始程序缺陷"></a>1.起始程序缺陷</h3><p>源程序方法无法复用<br>计费方式修改，无法保持一致性<br>分类规则修改，无法修改影片分类</p>
<h3 id="2-重构（refactor）第一步，建立测试方式，边测试边修改"><a href="#2-重构（refactor）第一步，建立测试方式，边测试边修改" class="headerlink" title="2.重构（refactor）第一步，建立测试方式，边测试边修改"></a>2.重构（refactor）第一步，建立测试方式，边测试边修改</h3><p>输入几个用户，让他们租用影片，预期结果与最后结果相比较</p>
<h3 id="3-分解Statement"><a href="#3-分解Statement" class="headerlink" title="3.分解Statement()"></a>3.分解Statement()</h3><p>找出逻辑谜团，运用Extract Method（110）。<br>本例中将Switch提取成独立的函数<br>怎么提炼？找到局部变量和参数，each和thisAmount，会修改的要格外小心，例如后者。</p>
<h3 id="4-修改变量名称"><a href="#4-修改变量名称" class="headerlink" title="4.修改变量名称"></a>4.修改变量名称</h3><h3 id="5-搬移变量从属类"><a href="#5-搬移变量从属类" class="headerlink" title="5.搬移变量从属类"></a>5.搬移变量从属类</h3><h2 id="二、重构原则"><a href="#二、重构原则" class="headerlink" title="二、重构原则"></a>二、重构原则</h2><h3 id="1-重构定义"><a href="#1-重构定义" class="headerlink" title="1.重构定义"></a>1.重构定义</h3><p>对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本。</p>
<h3 id="2-为何重构"><a href="#2-为何重构" class="headerlink" title="2.为何重构"></a>2.为何重构</h3><p>重构改进软件设计<br>重构使软件更容易理解<br>重构帮助找到bug<br>重构提高编程速度</p>
<h3 id="3-何时重构"><a href="#3-何时重构" class="headerlink" title="3.何时重构"></a>3.何时重构</h3><p>三次法则<br>理解别人代码，添加新功能重构<br>修改补充错误重构<br>复审代码重构</p>
<h3 id="4-间接层和重构"><a href="#4-间接层和重构" class="headerlink" title="4.间接层和重构"></a>4.间接层和重构</h3><p>重构为程序引入了更多间接层，重构把大型对象拆成多个小型对象，把大型函数拆成了小型函数。</p>
<blockquote>
<p>间接层价值：</p>
<ul>
<li>允许逻辑共享</li>
<li>分开解释意图和实现</li>
<li>隔离变化</li>
<li>封装条件逻辑</li>
</ul>
</blockquote>
<h3 id="5-重构与性能"><a href="#5-重构与性能" class="headerlink" title="5.重构与性能"></a>5.重构与性能</h3><p>1.时间预算法：给某个组件预先分配一定资源。包括时间与执行轨迹。每个组件不能超出自己的预算。</p>
<p>2.持续关注法：边写边优化。</p>
<p>3.性能提升发：大半时间浪费往往在一小半代码上，开发结束后，找出那个害群之马。</p>


    <!-- 显示photos -->
    

  </div>
  <div class="post-tags">
    <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SoftwareTesting/">SoftwareTesting</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/重构/">重构</a></li></ul>
  </div>
</article>
  
    <div class="post-nav">
      <div class="post-nav-item post-nav-next">
        
          <a href="/2017/05/23/EquivalencePartitioning/" rel="next" title="Equivalence Partitioning">
            <span>〈 </span> Equivalence Partitioning
          </a>
        
      </div>
  
      <div class="post-nav-item post-nav-prev">
        
          <a href="/2017/05/23/中国企业家应该尝试的15件事/" rel="prev" title="中国企业家应该尝试的15件事">
            中国企业家应该尝试的15件事 <span>〉</span>
          </a>
        
      </div>
    </div>
  


  <div id="toc" class="toc-article">
    <strong class="toc-title">目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、Refactoring，the-first-case"><span class="toc-text">一、Refactoring，the first case</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-起始程序缺陷"><span class="toc-text">1.起始程序缺陷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-重构（refactor）第一步，建立测试方式，边测试边修改"><span class="toc-text">2.重构（refactor）第一步，建立测试方式，边测试边修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-分解Statement"><span class="toc-text">3.分解Statement()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-修改变量名称"><span class="toc-text">4.修改变量名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-搬移变量从属类"><span class="toc-text">5.搬移变量从属类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、重构原则"><span class="toc-text">二、重构原则</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-重构定义"><span class="toc-text">1.重构定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-为何重构"><span class="toc-text">2.为何重构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-何时重构"><span class="toc-text">3.何时重构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-间接层和重构"><span class="toc-text">4.间接层和重构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-重构与性能"><span class="toc-text">5.重构与性能</span></a></li></ol></li></ol>
  </div>


    </div>

    

  </div>

  <footer class="footer text-center">
    <div id="bottom-inner">
      
        <a href="http://hexo.io" target="_blank" class="footer-link">Hexo</a>
      
        <a href="https://github.com/microacup/hexo-theme-micorb" target="_blank" class="footer-link">Theme microb</a>
      
    </div>
  </footer>
  

<!-- <script>
  var titleTime,originTitle=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="[闷声发大财中...] "+originTitle,clearTimeout(titleTime)):(document.title="[+1s] "+originTitle,titleTime=setTimeout(function(){document.title=originTitle},2e3))});
</script> -->

<script>
  (function (window, document) {
    window.requestAnimationFrame = (function () {
      return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function (callback) {
          setTimeout(callback, 1000 / 60);
        }
    })();

    function init() {
      addMenuEvent();
    }
    init();

    function addMenuEvent() {
      var menu = document.getElementById('menu-main-post');
      if (menu) {
        var toc = document.getElementById('toc');
        menu.title = toc ? '目录' : '回到顶部';
        menu.onclick = function () {
          if (toc) {
            if (toc.style.display == 'block') {
              toc.style.display = 'none';
            } else {
              toc.style.display = 'block';
            }
          } else {
            returnTop();
          }
        };
      }
    }

    var timer = null;

    function returnTop() {
      cancelAnimationFrame(timer);
      timer = requestAnimationFrame(function fn() {
        var oTop = document.body.scrollTop || document.documentElement.scrollTop;
        if (oTop > 0) {
          document.body.scrollTop = document.documentElement.scrollTop = oTop - 50;
          timer = requestAnimationFrame(fn);
        } else {
          cancelAnimationFrame(timer);
        }
      });
    }

  })(window, document);
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


  



</body>
</html>
